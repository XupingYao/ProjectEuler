(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 9.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[      8499,        283]
NotebookOptionsPosition[      7832,        254]
NotebookOutlinePosition[      8186,        270]
CellTagsIndexPosition[      8143,        267]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[TextData[{
 StyleBox["Pentagon numbers", "Title"],
 "\n",
 StyleBox["Problem 44", "Subtitle"],
 "\nPentagonal numbers are generated by the formula, ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["P", 
     RowBox[{"n", "="}]], 
    FractionBox["1", "2"], 
    RowBox[{"n", "(", 
     RowBox[{
      RowBox[{"3", "n"}], "-", "1"}], ")"}]}], TraditionalForm]]],
 ".  \nThe first ten pentagonal numbers are : 1, 5, 12, 22, 35, 51, 70, 92, \
117, 145, ...\nIt can be seen that ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["P", "4"], TraditionalForm]],
  FormatType->"TraditionalForm"],
 " + ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["P", "7"], TraditionalForm]],
  FormatType->"TraditionalForm"],
 " = 22 + 70 = 92 = ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["P", "8"], TraditionalForm]],
  FormatType->"TraditionalForm"],
 ".\nHowever, their difference, 70 \[Minus] 22 = 48, is not pentagonal.\n\n\
Find the pair of pentagonal numbers, ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["P", "j"], TraditionalForm]],
  FormatType->"TraditionalForm"],
 " and ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["P", "k"], TraditionalForm]],
  FormatType->"TraditionalForm"],
 ", for which their sum and difference are pentagonal and D = | ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["P", "k"], TraditionalForm]],
  FormatType->"TraditionalForm"],
 " \[Minus] ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["P", "j"], TraditionalForm]],
  FormatType->"TraditionalForm"],
 " | is minimised; what is the value of D?"
}], "Text",
 CellChangeTimes->{{3.6198345833246336`*^9, 3.619834616608285*^9}, {
  3.6588194051585255`*^9, 3.658819507937269*^9}}],

Cell[CellGroupData[{

Cell["Solution\t1", "Subsubtitle",
 CellChangeTimes->{{3.619834625628603*^9, 3.619834639195244*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", "\"\<`*\>\"", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ClearSystemCache", "[", "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"AbsoluteTiming", "[", 
  RowBox[{"Catch", "[", 
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"IntegerQ", "[", 
          FractionBox[
           RowBox[{"1", "+", 
            SqrtBox[
             RowBox[{"1", "+", 
              RowBox[{"12", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"3", "j"}], "-", "1"}], ")"}], "j"}], "+", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"3", "k"}], "-", "1"}], ")"}], "k"}]}], 
                ")"}]}]}]]}], "6"], "]"}], ",", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"IntegerQ", "[", 
            FractionBox[
             RowBox[{"1", "+", 
              SqrtBox[
               RowBox[{"1", "+", 
                RowBox[{"12", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"3", "j"}], "-", "1"}], ")"}], "j"}], "-", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"3", "k"}], "-", "1"}], ")"}], "k"}]}], 
                  ")"}]}]}]]}], "6"], "]"}], ",", 
           RowBox[{"Throw", "[", 
            RowBox[{
             FractionBox["1", "2"], 
             RowBox[{"(", 
              RowBox[{"j", "-", "k"}], ")"}], 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"3", "j"}], "+", 
               RowBox[{"3", "k"}], "-", "1"}], ")"}]}], "]"}]}], "]"}]}], 
        "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", 
         RowBox[{"k", "+", "1"}], ",", 
         RowBox[{"k", "+", "2000"}]}], "}"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"k", ",", "1", ",", "2000"}], "}"}]}], "]"}], "]"}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.6198252566932325`*^9, 3.6198254204734616`*^9}, {
  3.619826604652811*^9, 3.6198266304162846`*^9}, {3.6198267236872487`*^9, 
  3.619826727787483*^9}, {3.6808301919033732`*^9, 3.6808302092568398`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"26.569165481710375`", ",", "5482660"}], "}"}]], "Output",
 CellChangeTimes->{3.6198267162118216`*^9, 3.619826805355839*^9, 
  3.680830237851141*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Solution\t2", "Subsubtitle",
 CellChangeTimes->{{3.658824039835802*^9, 3.6588240490109444`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", "\"\<`*\>\"", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearSystemCache", "[", "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"P", "=", 
   RowBox[{
    RowBox[{"#", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"3", " ", "#"}], "-", "1"}], ")"}], "/", "2"}]}], "&"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"WjsQ", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"FractionalPart", "[", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Sqrt", "[", 
          RowBox[{
           RowBox[{"24.", " ", "#"}], "+", "1."}], "]"}], "+", "1."}], ")"}], 
       "/", "6."}], "]"}], "\[Equal]", "0"}], "&"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"cf", "=", 
   RowBox[{"Compile", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"WjsQ", "[", 
           RowBox[{
            RowBox[{"P", "[", "i", "]"}], "-", 
            RowBox[{"P", "[", "j", "]"}]}], "]"}], "&&", 
          RowBox[{"WjsQ", "[", 
           RowBox[{
            RowBox[{"P", "[", "i", "]"}], "+", 
            RowBox[{"P", "[", "j", "]"}]}], "]"}]}], ",", 
         RowBox[{
          RowBox[{"Print", "[", 
           RowBox[{
            RowBox[{"P", "[", "i", "]"}], "-", 
            RowBox[{"P", "[", "j", "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"Return", "[", "]"}]}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "10000"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "+", 
            RowBox[{"Sqrt", "[", 
             RowBox[{"1.", "+", 
              RowBox[{"6", " ", "i", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"3", " ", "i"}], "-", "1"}], ")"}]}]}], "]"}]}], 
           ")"}], "/", "6"}]}], "}"}]}], "]"}], ",", 
     RowBox[{"CompilationOptions", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"\"\<InlineExternalDefinitions\>\"", "\[Rule]", "True"}], 
       "}"}]}], ",", 
     RowBox[{"RuntimeOptions", "\[Rule]", "\"\<Speed\>\""}]}], "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"cf", "[", "]"}], "//", "AbsoluteTiming"}]}], "Input",
 CellChangeTimes->{{3.6588240541135645`*^9, 3.6588240585962768`*^9}}],

Cell[BoxData["5482660"], "Print",
 CellChangeTimes->{3.6588241119015646`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.8989561703537449`", ",", "Null"}], "}"}]], "Output",
 CellChangeTimes->{3.6588241119045653`*^9}]
}, Open  ]]
}, Open  ]]
},
WindowSize->{707, 506},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
FrontEndVersion->"10.4 for Microsoft Windows (64-bit) (2016\:5e744\:670817\
\:65e5)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[557, 20, 1648, 54, 245, "Text"],
Cell[CellGroupData[{
Cell[2230, 78, 100, 1, 28, "Subsubtitle"],
Cell[CellGroupData[{
Cell[2355, 83, 2480, 70, 372, "Input"],
Cell[4838, 155, 188, 4, 64, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[5075, 165, 102, 1, 28, "Subsubtitle"],
Cell[CellGroupData[{
Cell[5202, 170, 2381, 72, 392, "Input"],
Cell[7586, 244, 77, 1, 23, "Print"],
Cell[7666, 247, 138, 3, 31, "Output"]
}, Open  ]]
}, Open  ]]
}
]
*)


(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     14667,        449]
NotebookOptionsPosition[     13645,        407]
NotebookOutlinePosition[     14003,        423]
CellTagsIndexPosition[     13960,        420]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[TextData[{
 StyleBox["Optimum polynomial", "Title"],
 "\n",
 StyleBox["Problem 101", "Subtitle"],
 "\nIf we are presented with the first k terms of a sequence it is impossible \
to say with certainty the value of the next term, as there are infinitely \
many polynomial functions that can model the sequence.\n\nAs an example, let \
us consider the sequence of cube numbers.This is defined by the generating \
function,\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SubscriptBox["u", "n"], "=", 
     RowBox[{
      SuperscriptBox["n", "3"], ":", "1"}]}], ",", "8", ",", "27", ",", "64", 
    ",", "125", ",", "216", ",", "\[Ellipsis]"}], TraditionalForm]],
  FormatType->"TraditionalForm"],
 "\n\nSuppose we were only given the first two terms of this sequence. \
Working on the principle that \[OpenCurlyDoubleQuote]simple is best\
\[CloseCurlyDoubleQuote] we should assume a linear relationship and predict \
the next term to be 15 (common difference 7). Even if we were presented with \
the first three terms, by the same principle of simplicity, a quadratic \
relationship should be assumed.\n\nWe shall define ",
 Cell[BoxData[
  FormBox[
   RowBox[{"OP", "(", 
    RowBox[{"k", ",", "n"}], ")"}], TraditionalForm]],
  FormatType->"TraditionalForm"],
 " to be the ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["n", "th"], TraditionalForm]],
  FormatType->"TraditionalForm"],
 " term of the optimum polynomial generating function for the first k terms \
of a sequence. It should be clear that ",
 Cell[BoxData[
  FormBox[
   RowBox[{"OP", "(", 
    RowBox[{"k", ",", "n"}], ")"}], TraditionalForm]],
  FormatType->"TraditionalForm"],
 ", will accurately generate the terms of the sequence for ",
 Cell[BoxData[
  FormBox[
   RowBox[{"n", "\[LessEqual]", "k"}], TraditionalForm]],
  FormatType->"TraditionalForm"],
 " and potentially the first incorrect term (FIT) will be ",
 Cell[BoxData[
  FormBox[
   RowBox[{"OP", "(", 
    RowBox[{"k", ",", 
     RowBox[{"k", "+", "1"}]}], ")"}], TraditionalForm]],
  FormatType->"TraditionalForm"],
 "; in which case we shall call it a bad ",
 Cell[BoxData[
  FormBox[
   RowBox[{"OP", " ", 
    RowBox[{"(", "BOP", ")"}]}], TraditionalForm]],
  FormatType->"TraditionalForm"],
 ".\n\nAs a basis, if we were only given the first term of sequence, it would \
be most sensible to assume constancy; that is, for ",
 Cell[BoxData[
  FormBox[
   RowBox[{"n", "\[GreaterEqual]", "2"}], TraditionalForm]],
  FormatType->"TraditionalForm"],
 ", ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"OP", "(", 
     RowBox[{"1", ",", "n"}], ")"}], "=", 
    SubscriptBox["u", "1"]}], TraditionalForm]],
  FormatType->"TraditionalForm"],
 ".\n\nHence we obtain the following OPs for the cubic sequence:\n",
 Cell[BoxData[GridBox[{
    {Cell["OP(1,n)=1"], 
     RowBox[{"1", ",", 
      StyleBox["1",
       FontColor->RGBColor[1, 0, 0]], ",", "1", ",", "1", ",", 
      FormBox["\[Ellipsis]",
       TraditionalForm]}]},
    {Cell["OP(2,n)=7n-6"], 
     RowBox[{"1", ",", "8", ",", 
      StyleBox["15",
       FontColor->RGBColor[1, 0, 0]], ",", 
      FormBox["\[Ellipsis]",
       TraditionalForm]}]},
    {Cell[TextData[Cell[BoxData[
      FormBox[
       RowBox[{
        RowBox[{"OP", 
         RowBox[{"(", 
          RowBox[{"3", ",", "n"}], ")"}]}], "=", 
        RowBox[{
         RowBox[{"6", 
          SuperscriptBox["n", "2"]}], "-", 
         RowBox[{"11", "n"}], "+", "6"}]}], TraditionalForm]],
      FormatType->"TraditionalForm"]]], 
     RowBox[{"1", ",", "8", ",", "27", ",", 
      StyleBox["58",
       FontColor->RGBColor[1, 0, 0]], ",", 
      FormBox["\[Ellipsis]",
       TraditionalForm]}]},
    {Cell[TextData[Cell[BoxData[
      FormBox[
       RowBox[{
        RowBox[{"OP", 
         RowBox[{"(", 
          RowBox[{"4", ",", "n"}], ")"}]}], "=", 
        SuperscriptBox["n", "3"]}], TraditionalForm]],
      FormatType->"TraditionalForm"]]], 
     RowBox[{"1", ",", "8", ",", "27", ",", "64", ",", "125", ",", 
      FormBox["\[Ellipsis]",
       TraditionalForm]}]}
   }]]],
 "\n\nClearly no BOPs exist for ",
 Cell[BoxData[
  FormBox[
   RowBox[{"k", "\[GreaterEqual]", "4"}], TraditionalForm]],
  FormatType->"TraditionalForm"],
 ".\n\nBy considering the sum of FITs generated by the BOPs (indicated in ",
 StyleBox["red",
  FontColor->RGBColor[1, 0, 0]],
 " above), we obtain ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"1", " ", "+", " ", "15", " ", "+", " ", "58"}], " ", "=", " ", 
    "74"}], TraditionalForm]],
  FormatType->"TraditionalForm"],
 ".\n\nConsider the following tenth degree polynomial generating function:\n\n\
",
 Cell[BoxData[
  FormBox[
   RowBox[{"1", "-", "n", "+", 
    SuperscriptBox["n", "2"], "-", 
    SuperscriptBox["n", "3"], "+", 
    SuperscriptBox["n", "4"], "-", 
    SuperscriptBox["n", "5"], "+", 
    SuperscriptBox["n", "6"], "-", 
    SuperscriptBox["n", "7"], "+", 
    SuperscriptBox["n", "8"], "-", 
    SuperscriptBox["n", "9"], "+", 
    SuperscriptBox["n", "10"]}], TraditionalForm]],
  FormatType->"TraditionalForm"],
 "\n\nFind the sum of FITs for the BOPs."
}], "Text",
 CellChangeTimes->{{3.667906511031705*^9, 3.667906652716775*^9}, {
  3.6679066878970823`*^9, 3.667907295609605*^9}}],

Cell[CellGroupData[{

Cell["Solution\t1", "Subsubtitle",
 CellChangeTimes->{{3.6679073845236187`*^9, 3.6679073888997087`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearSystemCache", "[", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"AbsoluteTiming", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"sum", "=", "0"}], ";", "\[IndentingNewLine]", 
   RowBox[{"f", "=", 
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"-", "n"}], ")"}], "^", "i"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "0", ",", "10"}], "}"}]}], "]"}]}], ";", 
   "\[IndentingNewLine]", 
   RowBox[{"emax", "=", 
    RowBox[{"Exponent", "[", 
     RowBox[{"f", ",", "n"}], "]"}]}], ";", 
   RowBox[{"cmax", "=", 
    RowBox[{"Coefficient", "[", 
     RowBox[{"f", ",", "n", ",", "emax"}], "]"}]}], ";", 
   "\[IndentingNewLine]", 
   RowBox[{"While", "[", 
    RowBox[{
     RowBox[{"emax", "\[NotEqual]", "0"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"f", "=", 
       RowBox[{"f", "-", 
        RowBox[{"cmax", " ", 
         RowBox[{"Product", "[", 
          RowBox[{
           RowBox[{"n", "-", "i"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", "emax"}], "}"}]}], "]"}]}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"sum", "=", 
       RowBox[{
        RowBox[{"sum", "+", "f"}], "/.", 
        RowBox[{"n", "\[Rule]", 
         RowBox[{"(", 
          RowBox[{"emax", "+", "1"}], ")"}]}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"emax", "--"}], ";", 
      RowBox[{"cmax", "=", 
       RowBox[{"Coefficient", "[", 
        RowBox[{"f", ",", "n", ",", "emax"}], "]"}]}], ";"}]}], "]"}], ";", 
   "\[IndentingNewLine]", "sum"}], "]"}]}], "Input",
 CellChangeTimes->{{3.6679039335422096`*^9, 3.667904062373234*^9}, {
  3.6679040951655293`*^9, 3.6679043120824337`*^9}, {3.6679043882849035`*^9, 
  3.6679044663473654`*^9}, {3.6679045161827927`*^9, 3.667904524480506*^9}, {
  3.667904555021586*^9, 3.6679047554435596`*^9}, {3.6679048221769333`*^9, 
  3.6679048394393415`*^9}, {3.6679048750031633`*^9, 3.667904941227696*^9}, {
  3.6679050399234085`*^9, 3.6679050435817785`*^9}, {3.6679063879991236`*^9, 
  3.6679064966809835`*^9}, {3.6679073595984745`*^9, 3.667907377681608*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.005536412527758986`", ",", "37076114526"}], "}"}]], "Output",
 CellChangeTimes->{{3.6679064406429224`*^9, 3.6679064525447035`*^9}}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Solution\t2", "Subsubtitle",
 CellChangeTimes->{{3.667907394222172*^9, 3.6679074030502405`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearSystemCache", "[", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"AbsoluteTiming", "[", 
  RowBox[{
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"#", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "/.", 
       RowBox[{"n", "\[Rule]", 
        RowBox[{
         RowBox[{"#", "[", 
          RowBox[{"[", "2", "]"}], "]"}], "+", "2"}]}]}], "&"}], ",", 
     RowBox[{"Drop", "[", 
      RowBox[{
       RowBox[{"NestWhileList", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Simplify", "[", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"#", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "-", 
               RowBox[{
                RowBox[{"Coefficient", "[", 
                 RowBox[{
                  RowBox[{"#", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], ",", "n", ",", 
                  RowBox[{"#", "[", 
                   RowBox[{"[", "2", "]"}], "]"}]}], "]"}], 
                RowBox[{"Product", "[", 
                 RowBox[{
                  RowBox[{"n", "-", "i"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"i", ",", "1", ",", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], "]"}]}]}], 
              ")"}], "]"}], ",", 
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "-", "1"}]}], "}"}], "&"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{"#", ",", 
             RowBox[{"Exponent", "[", 
              RowBox[{"#", ",", "n"}], "]"}]}], "}"}], "&"}], "[", 
          RowBox[{"Sum", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"-", "n"}], ")"}], "^", "i"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "0", ",", "10"}], "}"}]}], "]"}], "]"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "2", "]"}], "]"}], ">", "0"}], "&"}]}], "]"}], ",", 
       "1"}], "]"}]}], "]"}], "//", "Total"}], "]"}]}], "Input",
 CellChangeTimes->{{3.667906296682302*^9, 3.6679063665663195`*^9}, {
  3.6679064112713547`*^9, 3.667906413135128*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.013858056967407986`", ",", "37076114526"}], "}"}]], "Output",
 CellChangeTimes->{{3.6679063366644354`*^9, 3.6679063678685207`*^9}, 
   3.6679064135354214`*^9, 3.667906463790562*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Solution\t3", "Subsubtitle",
 CellChangeTimes->{{3.667907899299591*^9, 3.667907920135645*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearSystemCache", "[", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"AbsoluteTiming", "[", 
  RowBox[{
   RowBox[{"InterpolatingPolynomial", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"-", "1"}], ")"}], "^", "i"}], 
          RowBox[{"#", "^", "i"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "0", ",", "10"}], "}"}]}], "]"}], "&"}], "~", 
      "Array", "~", "n"}], ",", 
     RowBox[{"n", "+", "1"}]}], "]"}], "~", "Sum", "~", 
   RowBox[{"{", 
    RowBox[{"n", ",", "10"}], "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.6679078306613398`*^9, 3.6679078803971415`*^9}, 
   3.6679083675438795`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.001243897946214542`", ",", "37076114526"}], "}"}]], "Output",
 CellChangeTimes->{{3.667907861951867*^9, 3.667907884186551*^9}, 
   3.6679083741055126`*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Solution 4", "Subsubtitle",
 CellChangeTimes->{{3.66790882101989*^9, 3.6679088322763557`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearSystemCache", "[", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"AbsoluteTiming", "[", 
  RowBox[{
   RowBox[{"s", "=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"1", "-", "n", "+", 
       RowBox[{"n", "^", "2"}], "-", 
       RowBox[{"n", "^", "3"}], "+", 
       RowBox[{"n", "^", "4"}], "-", 
       RowBox[{"n", "^", "5"}], "+", 
       RowBox[{"n", "^", "6"}], "-", 
       RowBox[{"n", "^", "7"}], "+", 
       RowBox[{"n", "^", "8"}], "-", 
       RowBox[{"n", "^", "9"}], "+", 
       RowBox[{"n", "^", "10"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"n", ",", "1", ",", "11"}], "}"}]}], "]"}]}], ";", "\n", 
   RowBox[{
    RowBox[{"Tr", "[", "s", "]"}], "-", 
    RowBox[{"First", "[", "s", "]"}], "-", 
    RowBox[{"Tr", "[", 
     RowBox[{"First", "/@", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Differences", "[", 
         RowBox[{"s", ",", "n"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"n", ",", "10"}], "}"}]}], "]"}]}], "]"}]}]}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.667908804537835*^9, 3.6679088135802984`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.00017476930246945743`", ",", "37076114526"}], "}"}]], "Output",
 CellChangeTimes->{3.6679088140488873`*^9}]
}, Open  ]]
}, Open  ]]
},
WindowSize->{759, 745},
WindowMargins->{{Automatic, 296}, {24, Automatic}},
FrontEndVersion->"10.3 for Microsoft Windows (64-bit) (2015\:5e7412\:670821\
\:65e5)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 5236, 148, 790, "Text"],
Cell[CellGroupData[{
Cell[5819, 172, 104, 1, 28, "Subsubtitle"],
Cell[CellGroupData[{
Cell[5948, 177, 2143, 52, 338, "Input"],
Cell[8094, 231, 173, 3, 31, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[8316, 240, 102, 1, 28, "Subsubtitle"],
Cell[CellGroupData[{
Cell[8443, 245, 2328, 64, 314, "Input"],
Cell[10774, 311, 223, 4, 31, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[11046, 321, 100, 1, 28, "Subsubtitle"],
Cell[CellGroupData[{
Cell[11171, 326, 789, 23, 162, "Input"],
Cell[11963, 351, 197, 4, 31, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[12209, 361, 100, 1, 28, "Subsubtitle"],
Cell[CellGroupData[{
Cell[12334, 366, 1131, 32, 162, "Input"],
Cell[13468, 400, 149, 3, 31, "Output"]
}, Open  ]]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
